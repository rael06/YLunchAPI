---
openapi: 3.0.0
info:
  title: YLunch API
  description: This is the API documentation of YLunch project for YDays projects of Sophia Ynov Campus
  contact:
    email: rael.calitro@ynov.com
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  version: 1.0.0
servers:
  - url: https://virtserver.swaggerhub.com/rael06/ylunch-api/1.0.0
    description: SwaggerHub API Auto Mocking
  - url: https://ylunch-api.rael-calitro.ovh
    description: Online server
  - url: http://localhost:5258
    description: Local server
security:
  - Bearer: []
tags:
  - name: trials
    description: Operations available to try the api
  - name: authentication
    description: authentication endpoints
  - name: users
    description: users endpoints
  - name: restaurants
    description: restaurants endpoints
  - name: products
    description: products endpoints
paths:
  /trials/anonymous:
    get:
      tags:
        - trials
      summary: Tries the api as anonymous
      description: |
        - Authorization header: **no**
      operationId: getAnonymousTry
      responses:
        "200":
          description: |
            Success
            - The anonymous trial Json object
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MessageDto"
              example:
                message: YLunchApi is running, you are anonymous.
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "BadRequest"
                statusCode: 400
                errors:
                  reasons: ["Something went wrong, please try again later."]
  /trials/authenticated:
    get:
      tags:
        - trials
      summary: Tries the api as authenticated based on accessToken in headers
      description: |
        - Authorization header: **yes**
        - Granted roles: 
          - All
      operationId: getAuthenticatedTry
      responses:
        "200":
          description: |
            Success
            - The authenticated trial Json object
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MessageDto"
              example:
                message: "YLunchApi is running, you are authenticated as {CurrentUserEmail} with Id: {CurrentUserId} and Roles: {CurrentUserRoles}."
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "BadRequest"
                statusCode: 400
                errors:
                  reasons: ["Something went wrong, please try again later."]
        "401":
          description: |
            Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Unauthorized"
                statusCode: 401
                errors:
                  reasons: ["Please login and use provided tokens."]
  /trials/authenticated-customer:
    get:
      tags:
        - trials
      summary: Tries the api as authenticated based on accessToken in headers
      description: |
        - Authorization header: **yes**
        - Granted roles: 
          - Customer
      operationId: getAuthenticatedCustomerTry
      responses:
        "200":
          description: |
            Success
            - The authenticated trial Json object
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MessageDto"
              example:
                message: "YLunchApi is running, you are authenticated as {CurrentUserEmail} with Id: {CurrentUserId} and Roles: {CurrentUserRoles}."
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "BadRequest"
                statusCode: 400
                errors:
                  reasons: ["Something went wrong, please try again later."]
        "401":
          description: |
            Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Unauthorized"
                statusCode: 401
                errors:
                  reasons: ["Please login and use provided tokens."]
        "403":
          description: |
            Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Forbidden"
                statusCode: 403
                errors:
                  reasons: ["User has not granted roles."]
  /trials/authenticated-restaurant-admin:
    get:
      tags:
        - trials
      summary: Tries the api as authenticated based on accessToken in headers
      description: |
        - Authorization header: **yes**
        - Granted roles: 
          - RestaurantAdmin
      operationId: getAuthenticatedRestaurantAdminTry
      responses:
        "200":
          description: |
            Success
            - The authenticated trial Json object
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MessageDto"
              example:
                message: "YLunchApi is running, you are authenticated as {CurrentUserEmail} with Id: {CurrentUserId} and Roles: {CurrentUserRoles}."
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "BadRequest"
                statusCode: 400
                errors:
                  reasons: ["Something went wrong, please try again later."]
        "401":
          description: |
            Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Unauthorized"
                statusCode: 401
                errors:
                  reasons: ["Please login and use provided tokens."]
        "403":
          description: |
            Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Forbidden"
                statusCode: 403
                errors:
                  reasons: ["User has not granted roles."]
  /authentication/login:
    post:
      tags:
        - authentication
      summary: Login a user and returns access and refresh tokens as Json Web Token
      description: |
        - Authorization header: **no**
      operationId: login
      requestBody:
        required: true
        description: A JSON object that contains the user name and password
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/LoginRequestDto"
            examples:
              restaurantAdmin:
                value:
                  email: admin@restaurant.com
                  password: Password1234.
              customer:
                value:
                  email: anne-marie.martin@ynov.com
                  password: Password1234.
      responses:
        "200":
          description: |
            Success
            - The access and refresh tokens
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              examples:
                ValidationError:
                  value:
                    title: "One or more validation errors occurred."
                    statusCode: 400
                    errors:
                      Email: ["The Email field is required."]
                Other:
                  value:
                    title: "BadRequest"
                    statusCode: 400
                    errors:
                      reasons: ["Something went wrong, please try again later."]
        "401":
          description: |
            Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Unauthorized"
                statusCode: 401
                errors:
                  reasons: ["Please login and use provided tokens."]
  /authentication/refresh-tokens:
    post:
      tags:
        - authentication
      summary: Refresh user's tokens and returns access and refresh tokens as Json Web Token
      description: |
        - Authorization header: **no**
      operationId: refreshTokens
      requestBody:
        required: true
        description: A JSON object that contains the access and refresh tokens
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/TokenUpdateDto"
      responses:
        "200":
          description: |
            Success
            - The new access and refresh tokens
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TokenReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              examples:
                ValidationError:
                  value:
                    title: "One or more validation errors occurred."
                    statusCode: 400
                    errors:
                      AccessToken: ["The AccessToken field is required."]
                Other:
                  value:
                    title: "BadRequest"
                    statusCode: 400
                    errors:
                      reasons: ["Something went wrong, please try again later."]
        "401":
          description: |
            Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Unauthorized"
                statusCode: 401
                errors:
                  reasons:
                    [
                      "Invalid tokens, please login to generate new valid tokens.",
                    ]
  /authentication/current-user:
    get:
      tags:
        - authentication
      summary: Gets the current user based on the access token in headers
      description: |
        - Authorization header: **yes**
        - Granted roles: 
          - All
      operationId: getCurrentUser
      responses:
        "200":
          description: |
            Success
            - The current user Json object
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "BadRequest"
                statusCode: 400
                errors:
                  reasons: ["Something went wrong, please try again later."]
        "401":
          description: |
            Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Unauthorized"
                statusCode: 401
                errors:
                  reasons: ["Please login and use provided tokens."]
  /authentication/logout:
    get:
      tags:
        - authentication
      summary: Logs out the current user
      description: |
        - Authorization header: **yes**
        - Granted roles: 
          - All
      operationId: logout
      responses:
        "204":
          description: |
            NoContent
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "BadRequest"
                statusCode: 400
                errors:
                  reasons: ["Something went wrong, please try again later."]
        "401":
          description: |
            Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Unauthorized"
                statusCode: 401
                errors:
                  reasons: ["Please login and use provided tokens."]
  /restaurant-admins:
    post:
      tags:
        - users
      summary: Restaurant admin registration
      description: |
        - Authorization header: **no**
      operationId: addRestaurantAdmin
      requestBody:
        description: User to register
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RestaurantAdminCreateDto"
      responses:
        "201":
          description: user created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              examples:
                ValidationError:
                  value:
                    title: "One or more validation errors occurred."
                    statusCode: 400
                    errors:
                      Name: ["The Name field is required."]
                Other:
                  value:
                    title: "BadRequest"
                    statusCode: 400
                    errors:
                      reasons: ["Something went wrong, please try again later."]
        "409":
          description: |
            Conflict
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Conflict"
                statusCode: 409
                errors:
                  reasons: ["User already exists."]
  /customers:
    post:
      tags:
        - users
      summary: Customer registration
      description: |
        - Authorization header: **no**
      operationId: addCustomer
      requestBody:
        description: User to register
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CustomerCreateDto"
      responses:
        "201":
          description: user created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/UserReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              examples:
                ValidationError:
                  value:
                    title: "One or more validation errors occurred."
                    statusCode: 400
                    errors:
                      Name: ["The Name field is required."]
                Other:
                  value:
                    title: "BadRequest"
                    statusCode: 400
                    errors:
                      reasons: ["Something went wrong, please try again later."]
        "409":
          description: |
            Conflict
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Conflict"
                statusCode: 409
                errors:
                  reasons: ["User already exists."]
  /restaurants:
    post:
      tags:
        - restaurants
      summary: Restaurant creation
      description: |
        - Authorization header: **yes**
        - Granted roles:
          - RestaurantAdmin
      operationId: addRestaurant
      requestBody:
        description: Restaurant to create
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RestaurantCreateDto"
      responses:
        "201":
          description: restaurant created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RestaurantReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              examples:
                ValidationError:
                  value:
                    title: "One or more validation errors occurred."
                    statusCode: 400
                    errors:
                      Name: ["The Name field is required."]
                Other:
                  value:
                    title: "BadRequest"
                    statusCode: 400
                    errors:
                      reasons: ["Something went wrong, please try again later."]
        "409":
          description: |
            Conflict
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Conflict"
                statusCode: 409
                errors:
                  reasons: ["Restaurant already exists."]
    get:
      tags:
        - restaurants
      summary: Gets restaurants ordered by creationDateTime
      description: |
        - Authorization header: **no**
      operationId: getRestaurants
      parameters:
        - in: query
          name: restaurantAdminId
          required: false
          description: To filter the restaurants that are related to the restaurantAdmin id. Default null to ignore this param and get all.
          schema:
            type: string
            example: a00000e0-aaa0-000a-0000-00e00aa00e00
        - in: query
          name: isPublished
          required: false
          description: To filter the restaurants that are published or not. Default null to get both.
          schema:
            type: boolean
        - in: query
          name: isCurrentlyOpenToOrder
          required: false
          description: To filter the restaurants that are currently open to order or not. Default null to get both.
          schema:
            type: boolean
        - in: query
          name: page
          required: false
          description: The page you want within 1 and 10 000. Default 1.
          schema:
            type: number
        - in: query
          name: size
          required: false
          description: The size you want within 1 and 30. Default 30.
          schema:
            type: number
      responses:
        "200":
          description: |
            Success
            - The restaurants
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/RestaurantReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "BadRequest"
                statusCode: 400
                errors:
                  reasons: ["Something went wrong, please try again later."]
  /restaurants/{restaurantId}:
    get:
      tags:
        - restaurants
      summary: Gets a restaurant by id
      description: |
        - Authorization header: **no**
      operationId: getRestaurantById
      parameters:
        - in: path
          name: restaurantId
          required: true
          description: The id of the restaurant you want to get
          schema:
            type: string
      responses:
        "200":
          description: |
            Success
            - The restaurant
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RestaurantReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "BadRequest"
                statusCode: 400
                errors:
                  reasons: ["Something went wrong, please try again later."]
        "401":
          description: |
            Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Unauthorized"
                statusCode: 401
                errors:
                  reasons: ["Please login and use provided tokens."]
        "404":
          description: |
            Not found:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "NotFound"
                statusCode: 404
                errors:
                  reasons:
                    [
                      "Restaurant: a00000e0-aaa0-000a-0000-00e00aa00e00 not found.",
                    ]
  /restaurants/{restaurantId}/products:
    post:
      tags:
        - products
      summary: Product creation
      description: |
        - Authorization header: **yes**
        - Granted roles:
          - RestaurantAdmin
      operationId: addProduct
      parameters:
        - in: path
          name: restaurantId
          required: true
          description: The id of the restaurant in which you want to create a product
          schema:
            type: string
      requestBody:
        description: Product to create
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/ProductCreateDto"
      responses:
        "201":
          description: product created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ProductReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              examples:
                ValidationError:
                  value:
                    title: "One or more validation errors occurred."
                    statusCode: 400
                    errors:
                      Name: ["The Name field is required."]
                Other:
                  value:
                    title: "BadRequest"
                    statusCode: 400
                    errors:
                      reasons: ["Something went wrong, please try again later."]
        "404":
          description: |
            Not found:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "NotFound"
                statusCode: 404
                errors:
                  reasons:
                    [
                      "Restaurant: a00000e0-aaa0-000a-0000-00e00aa00e00 not found.",
                    ]
        "409":
          description: |
            Conflict
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Conflict"
                statusCode: 409
                errors:
                  reasons: ["Product already exists."]
    get:
      tags:
        - products
      summary: Gets products ordered by name
      description: |
        - Authorization header: **no**
      operationId: getProducts
      parameters:
        - in: path
          name: restaurantId
          required: true
          description: The id of the restaurant you want to get the products.
          schema:
            type: string
        - in: query
          name: page
          required: false
          description: The page you want within 1 and 10 000. Default 1.
          schema:
            type: number
        - in: query
          name: size
          required: false
          description: The size you want within 1 and 250. Default 250.
          schema:
            type: number
        - in: query
          name: isAvailable
          required: false
          description: To filter the products that are available or not. Default null to get both. A product is available when isActive is true, quantity is null or > 1, expirationDateTime is null or in the future.
          schema:
            type: boolean
        - in: query
          name: productIds
          required: false
          explode: true
          description: |
            To filter the products having the id matching one of this `set` of id.  
            Repeat this parameter to filter on multiple id.  
            Duplicates will be ignored.
          schema:
            type: array
            items:
              type: string
      responses:
        "200":
          description: |
            Success
            - The products
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/ProductReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "BadRequest"
                statusCode: 400
                errors:
                  reasons: ["Something went wrong, please try again later."]
        "404":
          description: |
            Not found:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "NotFound"
                statusCode: 404
                errors:
                  reasons:
                    [
                      "Restaurant: a00000e0-aaa0-000a-0000-00e00aa00e00 not found.",
                    ]
  /products/{productId}:
    get:
      tags:
        - products
      summary: Gets a product by id
      description: |
        - Authorization header: **no**
      operationId: getProductById
      parameters:
        - in: path
          name: productId
          required: true
          description: The id of the product you want to get
          schema:
            type: string
      responses:
        "200":
          description: |
            Success
            - The product
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ProductReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "BadRequest"
                statusCode: 400
                errors:
                  reasons: ["Something went wrong, please try again later."]
        "404":
          description: |
            Not found:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "NotFound"
                statusCode: 404
                errors:
                  reasons:
                    ["Product: a00000e0-aaa0-000a-0000-00e00aa00e00 not found."]
  /restaurants/{restaurantId}/orders:
    post:
      tags:
        - orders
      summary: Order creation
      description: |
        - Authorization header: **yes**
        - Granted roles:
          - Customer
      operationId: addOrder
      parameters:
        - in: path
          name: restaurantId
          required: true
          description: The id of the restaurant in where you want to order
          schema:
            type: string
      requestBody:
        description: Order to create
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/OrderCreateDto"
      responses:
        "201":
          description: order created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              examples:
                ValidationError:
                  value:
                    title: "One or more validation errors occurred."
                    statusCode: 400
                    errors:
                      ProductIds: ["The ProductIds field is required."]
                Other:
                  value:
                    title: "BadRequest"
                    statusCode: 400
                    errors:
                      reasons: ["Something went wrong, please try again later."]
        "401":
          description: |
            Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Unauthorized"
                statusCode: 401
                errors:
                  reasons: ["Please login and use provided tokens."]
        "403":
          description: |
            Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Forbidden"
                statusCode: 403
                errors:
                  reasons: ["User has not granted roles."]
        "404":
          description: |
            Not found:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              examples:
                RestaurantNotFound:
                  value:
                    title: "NotFound"
                    statusCode: 404
                    errors:
                      reasons:
                        [
                          "Restaurant: a00000e0-aaa0-000a-0000-00e00aa00e00 not found.",
                        ]
                ProductsNotFound:
                  value:
                    title: "NotFound"
                    statusCode: 404
                    errors:
                      reasons:
                        [
                          "Products: a00000e0-aaa0-000a-0000-00e00aa00e00 and b11111f1-bbb1-111b-1111-11f11bb11f11 not found.",
                        ]
    get:
      tags:
        - orders
      summary: Gets orders ordered by creationDateTime
      description: |
        - Authorization header: **yes**
        - Granted roles:
          - RestaurantAdmin
      operationId: getOrdersOfRestaurant
      parameters:
        - in: path
          name: restaurantId
          required: true
          description: The id of the restaurant you want to get the orders.
          schema:
            type: string
        - in: query
          name: customerId
          required: false
          description: The id of the customer you want to get the orders.
          schema:
            type: string
        - in: query
          name: page
          required: false
          description: The page you want within 1 and 10 000. Default 1.
          schema:
            type: number
        - in: query
          name: size
          required: false
          description: The size you want within 1 and 50. Default 50.
          schema:
            type: number
        - in: query
          name: minCreationDateTime
          required: false
          schema:
            type: string
            example: "2021-12-31T00:00:00.000000"
          description: The minimum date of filtered orders creation date time.
        - in: query
          name: maxCreationDateTime
          required: false
          schema:
            type: string
            example: "2021-12-31T00:00:00.000000"
          description: The maximum date of filtered orders creation date time.
        - in: query
          name: orderStates
          required: false
          explode: true
          description: |
            To filter the orders having their current state matching one of this `set` of states.  
            Repeat this parameter to filter on multiple states.  
            Duplicates will be ignored.  
            One of:
              - `0`: Idling,
              - `1`: Acknowledged,
              - `2`: InPreparation,
              - `3`: Ready,
              - `4`: Delivered,
              - `5`: Other,
              - `6`: Cancelled,
              - `7`: Rejected
          schema:
            type: array
            items:
              type: number
      responses:
        "200":
          description: |
            Success
            - The orders
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/OrderReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "BadRequest"
                statusCode: 400
                errors:
                  reasons: ["Something went wrong, please try again later."]
        "401":
          description: |
            Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Unauthorized"
                statusCode: 401
                errors:
                  reasons: ["Please login and use provided tokens."]
        "403":
          description: |
            Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Forbidden"
                statusCode: 403
                errors:
                  reasons: ["User has not granted roles."]
        "404":
          description: |
            Not found:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "NotFound"
                statusCode: 404
                errors:
                  reasons:
                    [
                      "Restaurant: a00000e0-aaa0-000a-0000-00e00aa00e00 not found.",
                    ]
  /orders:
    get:
      tags:
        - orders
      summary: Gets orders ordered by creationDateTime
      description: |
        - Authorization header: **yes**
        - Granted roles:
          - Customer
      operationId: getOrdersOfCurrentCustomer
      parameters:
        - in: query
          name: restaurantId
          required: false
          description: The id of the restaurant you want to get the orders.
          schema:
            type: string
        - in: query
          name: page
          required: false
          description: The page you want within 1 and 10 000. Default 1.
          schema:
            type: number
        - in: query
          name: size
          required: false
          description: The size you want within 1 and 50. Default 50.
          schema:
            type: number
        - in: query
          name: minCreationDateTime
          required: false
          schema:
            type: string
            example: "2021-12-31T00:00:00.000000"
          description: The minimum date of filtered orders creation date time.
        - in: query
          name: maxCreationDateTime
          required: false
          schema:
            type: string
            example: "2021-12-31T00:00:00.000000"
          description: The maximum date of filtered orders creation date time.
        - in: query
          name: orderStates
          required: false
          explode: true
          description: |
            To filter the orders having their current state matching one of this `set` of states.  
            Repeat this parameter for multiple to filter on multiple states.  
            Duplicates will be ignored.  
            One of:
              - `0`: Idling,
              - `1`: Acknowledged,
              - `2`: InPreparation,
              - `3`: Ready,
              - `4`: Delivered,
              - `5`: Other,
              - `6`: Cancelled,
              - `7`: Rejected
          schema:
            type: array
            items:
              type: number
      responses:
        "200":
          description: |
            Success
            - The orders
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/OrderReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "BadRequest"
                statusCode: 400
                errors:
                  reasons: ["Something went wrong, please try again later."]
        "401":
          description: |
            Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Unauthorized"
                statusCode: 401
                errors:
                  reasons: ["Please login and use provided tokens."]
        "403":
          description: |
            Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Forbidden"
                statusCode: 403
                errors:
                  reasons: ["User has not granted roles."]
        "404":
          description: |
            Not found:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "NotFound"
                statusCode: 404
                errors:
                  reasons:
                    [
                      "Restaurant: a00000e0-aaa0-000a-0000-00e00aa00e00 not found.",
                    ]
  /orders/{orderId}:
    get:
      tags:
        - orders
      summary: Gets an order by id
      description: |
        - Authorization header: **no**
      operationId: getOrderById
      parameters:
        - in: path
          name: orderId
          required: true
          description: The id of the order you want to get
          schema:
            type: string
      responses:
        "200":
          description: |
            Success
            - The order
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/OrderReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "BadRequest"
                statusCode: 400
                errors:
                  reasons: ["Something went wrong, please try again later."]
        "404":
          description: |
            Not found:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "NotFound"
                statusCode: 404
                errors:
                  reasons:
                    ["Order: a00000e0-aaa0-000a-0000-00e00aa00e00 not found."]
  /restaurants/{restaurantId}/orders/statuses:
    post:
      tags:
        - orders
      summary: Add status to multiple orders
      description: |
        - Authorization header: **yes**
        - Granted roles:
          - RestaurantAdmin
      operationId: addStatusToOrders
      parameters:
        - in: path
          name: restaurantId
          required: true
          description: The id of the restaurant to which belong the orders you want to add a status
          schema:
            type: string
      requestBody:
        description: Array of id of orders plus the state you want to add to them
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/AddStatusToOrdersDto"
      responses:
        "201":
          description: updated orders with the new status as the current one
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: "#/components/schemas/OrderReadDto"
        "400":
          description: |
            Bad request
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              examples:
                ValidationError:
                  value:
                    title: "One or more validation errors occurred."
                    statusCode: 400
                    errors:
                      OrderIds: ["The OrderIds field is required."]
                Other:
                  value:
                    title: "BadRequest"
                    statusCode: 400
                    errors:
                      reasons: ["Something went wrong, please try again later."]
        "401":
          description: |
            Unauthorized
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Unauthorized"
                statusCode: 401
                errors:
                  reasons: ["Please login and use provided tokens."]
        "403":
          description: |
            Forbidden
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              example:
                title: "Forbidden"
                statusCode: 403
                errors:
                  reasons: ["User has not granted roles."]
        "404":
          description: |
            Not found:
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorDto"
              examples:
                RestaurantNotFound:
                  value:
                    title: "NotFound"
                    statusCode: 404
                    errors:
                      reasons:
                        [
                          "Restaurant: a00000e0-aaa0-000a-0000-00e00aa00e00 not found.",
                        ]
                OrdersNotFound:
                  value:
                    title: "NotFound"
                    statusCode: 404
                    errors:
                      reasons:
                        [
                          "Orders: a00000e0-aaa0-000a-0000-00e00aa00e00 and b11111f1-bbb1-111b-1111-11f11bb11f11 not found.",
                        ]
components:
  schemas:
    MessageDto:
      properties:
        message:
          type: string
          description: The message.
    ErrorDto:
      properties:
        title:
          type: string
          description: The title.
        statusCode:
          type: number
          description: The status code.
        errors:
          properties:
            reasons:
              type: array
              items:
                type: string
                description: The reason.
    LoginRequestDto:
      type: object
      properties:
        email:
          type: string
          format: email
          example: anne-marie.martin@ynov.com
        password:
          type: string
          example: Password1234.
      required:
        - email
        - password
    TokenReadDto:
      type: object
      properties:
        accessToken:
          type: string
          example: |
            eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJJZCI6ImFlNTcxOGJkLWY5NzktNDQ1Ni04MmRlLTBjNzgzMzk4NzYzNCIsImp0aSI6IjBjZjc3NGYwLTUxYWQtNDM4Yi1hNTZlLTI1N2VlZGRhMjQ0MCIsIm5iZiI6MTY0MTEzNzMxMCwiZXhwIjoxNjQxMTU4OTEwLCJpYXQiOjE2NDExMzczMTB9.q1VaAodjovu79AyBNbrSxu4yZ4vOlDZQF2IyDvcsbJM
        refreshToken:
          type: string
          example: abcdefghij-a00000e0-aaa0-000a-0000-00e00aa00e00
    TokenUpdateDto:
      type: object
      properties:
        accessToken:
          type: string
          example: |
            eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJJZCI6ImFlNTcxOGJkLWY5NzktNDQ1Ni04MmRlLTBjNzgzMzk4NzYzNCIsImp0aSI6IjBjZjc3NGYwLTUxYWQtNDM4Yi1hNTZlLTI1N2VlZGRhMjQ0MCIsIm5iZiI6MTY0MTEzNzMxMCwiZXhwIjoxNjQxMTU4OTEwLCJpYXQiOjE2NDExMzczMTB9.q1VaAodjovu79AyBNbrSxu4yZ4vOlDZQF2IyDvcsbJM
        refreshToken:
          type: string
          example: abcdefghij-a00000e0-aaa0-000a-0000-00e00aa00e00
      required:
        - accessToken
        - refreshToken
    RestaurantAdminCreateDto:
      type: object
      properties:
        email:
          type: string
          format: email
          example: admin@restaurant.com
          description: "It should be lowercase email format and could contain '.', '-' and/or '_' characters."
        firstname:
          type: string
          example: Jean-Marc
        lastname:
          type: string
          example: Dupont Henri
        phoneNumber:
          type: string
          format: phone
          example: "0612345678"
        password:
          type: string
          format: password
          example: Password1234.
      required:
        - email
        - firstname
        - lastname
        - password
        - phoneNumber
    CustomerCreateDto:
      type: object
      properties:
        email:
          type: string
          format: email
          example: anne-marie.martin@ynov.com
          description: "It should be a lowercase Ynov email format and could contain '.', '-' and/or '_' characters."
        firstname:
          type: string
          example: Anne-Marie
        lastname:
          type: string
          example: Martin-Jacques
        phoneNumber:
          type: string
          format: phone
          example: "0687654321"
        password:
          type: string
          format: password
          example: Password1234.
      required:
        - email
        - firstname
        - lastname
        - password
        - phoneNumber
    UserReadDto:
      type: object
      properties:
        id:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        email:
          type: string
          format: email
          example: user@domain.com
        firstname:
          type: string
          example: Anne-Marie
        lastname:
          type: string
          example: Martin-Jacques
        phoneNumber:
          type: string
          format: phone
          example: "0687654321"
        roles:
          type: array
          example:
            - RestaurantAdmin
          items:
            type: string
    ClosingDateCreateDto:
      type: object
      properties:
        closingDateTime:
          type: string
          example: "2021-12-31T00:00:00.000000"
      required:
        - closingDateTime
    ClosingDateReadDto:
      type: object
      properties:
        closingDateTime:
          type: string
          example: "2021-12-31T00:00:00.000000"
    OpeningTimeCreateDto:
      type: object
      properties:
        dayOfWeek:
          type: number
          description: "The day to apply this opening time. Starting from Sunday: 0 to Saturday: 6, for example 4 is thursday."
          example: 4
        offsetInMinutes:
          type: number
          description: |
            Number of minutes past from 00:00 for example 10:00 is 600, which means the restaurant is open since 10:00.  
              `Warning`: Must be calculated from `UTC` time.
          example: 600
        durationInMinutes:
          type: number
          description: "Number of minutes the restaurant is open since the offset, for example 120 minutes, which means the restaurant is open during 2h since 10:00."
          example: 120
      required:
        - dayOfWeek
        - offsetInMinutes
        - durationInMinutes
    OpeningTimeReadDto:
      type: object
      properties:
        id:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        restaurantId:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        dayOfWeek:
          type: number
          description: "The day to apply this opening time. Starting from Sunday: 0 to Saturday: 6, for example 4 is thursday."
          example: 4
        offsetInMinutes:
          type: number
          description: |
            Number of minutes past from 00:00 for example 10:00 is 600, which means the restaurant is open since 10:00.  
              `Warning`: It's calculated from `UTC` time.
          example: 600
        durationInMinutes:
          type: number
          description: "Number of minutes the restaurant is open since the offset, for example 120 minutes, which means the restaurant is open during 2h since 10:00."
          example: 120
    RestaurantCreateDto:
      type: object
      properties:
        name:
          type: string
          example: my restaurant
        phoneNumber:
          type: string
          format: phone
          example: "0612345678"
        email:
          type: string
          format: email
          example: my.restaurant@restaurant.com
        isOpen:
          type: boolean
          description: |
            Boolean to set manually if the restaurant is open or not:
            - `False`: the restaurant will be set as closed regardless of closing dates and opening times.
            - `True`: the restaurant will be set as open regarding closing dates and opening times.
          example: true
        isPublic:
          type: boolean
          description: "True if the restaurant wants to be visible for customers, actual visibility value is `isPublished` (refer to that field in `RestaurantReadDto`for details)."
          example: true
        zipCode:
          type: string
          example: "06560"
        country:
          type: string
          example: France
        city:
          type: string
          example: Valbonne
        streetNumber:
          type: string
          example: "1"
        streetName:
          type: string
          example: Place Sophie Lafitte
        addressExtraInformation:
          type: string
          example: Bât. G
        closingDates:
          type: array
          items:
            $ref: "#/components/schemas/ClosingDateCreateDto"
        placeOpeningTimes:
          type: array
          items:
            $ref: "#/components/schemas/OpeningTimeCreateDto"
        orderOpeningTimes:
          type: array
          items:
            $ref: "#/components/schemas/OpeningTimeCreateDto"
        base64Image:
          type: string
          description: Base 64 encoded image
          example: "data:image/png;base64,iVBORw0KGgoAAA..."
        base64Logo:
          type: string
          description: Base 64 encoded logo
          example: "data:image/png;base64,iVBORw0KGgoAAA..."
      required:
        - name
        - email
        - phoneNumber
        - zipCode
        - country
        - city
        - streetName
        - streetNumber
        - isOpen
        - isPublic
    RestaurantReadDto:
      type: object
      properties:
        id:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        name:
          type: string
          example: my restaurant
        phoneNumber:
          type: string
          format: phone
          example: "0612345678"
        email:
          type: string
          format: email
          example: my.restaurant@restaurant.com
        isOpen:
          type: boolean
          description: |
            Boolean to set manually if the restaurant is open or not:
            - `False`: the restaurant will be set as closed regardless of closing dates and opening times.
            - `True`: the restaurant will be set as open regarding closing dates and opening times.
          example: true
        isPublic:
          type: boolean
          description: "True if the restaurant wants to be visible for customers, actual display value is `isPublished` (refer to that field for details)."
          example: true
        zipCode:
          type: string
          example: "06560"
        country:
          type: string
          example: France
        city:
          type: string
          example: Valbonne
        streetNumber:
          type: string
          example: "1"
        streetName:
          type: string
          example: Place Sophie Lafitte
        addressExtraInformation:
          type: string
          example: Bât. G
        closingDates:
          type: array
          items:
            $ref: "#/components/schemas/ClosingDateReadDto"
        placeOpeningTimes:
          type: array
          items:
            $ref: "#/components/schemas/OpeningTimeReadDto"
        orderOpeningTimes:
          type: array
          items:
            $ref: "#/components/schemas/OpeningTimeReadDto"
        base64Image:
          type: string
          description: Base 64 encoded image
          example: "data:image/png;base64,iVBORw0KGgoAAA..."
        base64Logo:
          type: string
          description: Base 64 encoded logo
          example: "data:image/png;base64,iVBORw0KGgoAAA..."
        isPublished:
          type: boolean
          description: "This is true if the restaurant has a value for all the required fields of `RestaurantCreateDto` plus at least one opening time and one product which has isActive value set to true. If true, the restaurant is visible for customers"
          example: true
        isCurrentlyOpenToOrder:
          type: boolean
          description: "True if the restaurant accepts orders."
        isCurrentlyOpenInPlace:
          type: boolean
          description: "True if the restaurant is open to eat in place."
    AllergenCreateDto:
      type: object
      properties:
        name:
          type: string
          example: gluten
          description: Must be lowercase.
    AllergenReadDto:
      type: object
      properties:
        id:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        name:
          type: string
          example: gluten
    ProductTagCreateDto:
      type: object
      properties:
        name:
          type: string
          example: pizza
          description: Must be lowercase. A tag to categorise a product.
    ProductTagReadDto:
      type: object
      properties:
        id:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        name:
          type: string
          example: pizza
    ProductCreateDto:
      type: object
      properties:
        name:
          type: string
          example: My product
        description:
          type: string
          example: My first ingredient, my second ingredient
        price:
          type: number
          example: 9.8
        quantity:
          type: number
          description: Must be between 1 and 10000 or `null` meaning infinite.
          example: 3
        isActive:
          type: boolean
          description: |
            - `True` if the product is available
            - `False` to force a product to be unavailable, bypasses the quantity'
          example: true
        productType:
          type: number
          example: "0"
          description: |
            One of:
            - `0`: Starter,
            - `1`: Main,
            - `2`: Dessert,
            - `3`: Drink,
            - `4`: Menu,
            - `5`: Daily,
            - `6`: Other
        expirationDateTime:
          type: string
          example: "2021-12-31T00:00:00.000000"
          description: Must be in the future.
        image:
          type: string
          description: Base 64 encoded image
          example: "data:image/png;base64,iVBORw0KGgoAAA..."
        allergens:
          type: array
          items:
            $ref: "#/components/schemas/AllergenCreateDto"
        productTags:
          type: array
          items:
            $ref: "#/components/schemas/ProductTagCreateDto"
      required:
        - name
        - price
        - isActive
        - productType
        - allergens
    ProductReadDto:
      type: object
      properties:
        id:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        restaurantId:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        name:
          type: string
          example: my product
        description:
          type: string
          example: my ingredients
        price:
          type: number
          example: 9.8
        quantity:
          type: number
          description: Quantity of product between 1 and 10000 or `null` meaning infinite.
          example: 3
        isActive:
          type: boolean
          description: |
            - `True` if the product is available
            - `False` if the product is unavailable, bypasses the quantity'
          example: true
        productType:
          type: number
          example: 0
          description: |
            One of:
            - `0`: Starter,
            - `1`: Main,
            - `2`: Dessert,
            - `3`: Drink,
            - `4`: Menu,
            - `5`: Daily,
            - `6`: Other
        creationDateTime:
          type: string
          example: "2021-12-31T00:00:00.000000"
        expirationDateTime:
          type: string
          example: "2021-12-31T00:00:00.000000"
        image:
          type: string
          description: Base 64 encoded image
          example: "data:image/png;base64,iVBORw0KGgoAAA..."
        allergens:
          type: array
          items:
            $ref: "#/components/schemas/AllergenReadDto"
        productTags:
          type: array
          items:
            $ref: "#/components/schemas/ProductTagReadDto"
    OrderedProductReadDto:
      type: object
      properties:
        id:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        productId:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        restaurantId:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        orderId:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        userId:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        name:
          type: string
          example: my product
        description:
          type: string
          example: my ingredients
        allergens:
          type: string
          example: "arachide, gluten"
          description: ordered by name
        productTags:
          type: string
          example: "italienne, pizza"
          description: ordered by name
        price:
          type: number
          example: 9.8
        productType:
          type: number
          example: 0
          description: |
            One of:
            - `0`: Starter,
            - `1`: Main,
            - `2`: Dessert,
            - `3`: Drink,
            - `4`: Menu,
            - `5`: Daily,
            - `6`: Other
        creationDateTime:
          type: string
          example: "2021-12-31T00:00:00.000000"
        expirationDateTime:
          type: string
          example: "2021-12-31T00:00:00.000000"
        image:
          type: string
          description: Base 64 encoded image
          example: "data:image/png;base64,iVBORw0KGgoAAA..."
    OrderStatusReadDto:
      type: object
      properties:
        id:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        orderId:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        orderState:
          type: number
          example: 0
          description: |
            One of:
            - `0`: Idling,
            - `1`: Acknowledged,
            - `2`: InPreparation,
            - `3`: Ready,
            - `4`: Delivered,
            - `5`: Other,
            - `6`: Cancelled,
            - `7`: Rejected
        dateTime:
          type: string
          example: "2021-12-31T00:00:00.000000"
    OrderCreateDto:
      type: object
      properties:
        productIds:
          type: array
          items:
            type: string
            example: a00000e0-aaa0-000a-0000-00e00aa00e00
        reservedForDateTime:
          type: string
          example: "2021-12-31T00:00:00.000000"
          description: "Must be in future and within restaurant place opening times"
        customerComment:
          type: string
          example: "without onions"
      required:
        - productIds
        - reservedForDateTime
    OrderReadDto:
      type: object
      properties:
        id:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        userId:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        restaurantId:
          type: string
          example: a00000e0-aaa0-000a-0000-00e00aa00e00
        totalPrice:
          type: number
          example: 19.6
        creationDateTime:
          type: string
          example: "2021-12-31T00:00:00.000000"
        reservedForDateTime:
          type: string
          example: "2021-12-31T00:00:00.000000"
        acceptationDateTime:
          type: string
          example: "2021-12-31T00:00:00.000000"
        customerComment:
          type: string
          example: "without onions"
        restaurantComment:
          type: string
          example: "ok, we remove onions"
        isAcknowledged:
          type: boolean
          description: |
            - `True` if the restaurant is aware of the order
            - `False` if the restaurant is not aware of the order
          example: true
        isAccepted:
          type: boolean
          description: |
            - `True` if the restaurant has accepted the order
            - `False` if the restaurant has not accepted the order
          example: true
        isDeleted:
          type: boolean
          description: |
            - `True` if the order is processed
            - `False` if the order is still processing
          example: true
        currentOrderStatus:
          $ref: "#/components/schemas/OrderStatusReadDto"
        orderStatuses:
          type: array
          items:
            $ref: "#/components/schemas/OrderStatusReadDto"
        orderedProducts:
          type: array
          items:
            $ref: "#/components/schemas/OrderedProductReadDto"
    AddStatusToOrdersDto:
      type: object
      properties:
        orderIds:
          type: array
          items:
            type: string
          example:
            [
              a00000e0-aaa0-000a-0000-00e00aa00e00,
              b11111f1-bbb1-111b-1111-11f11bb11f11,
            ]
        orderState:
          type: number
          example: 1
          description: |
            One of:
            - `0`: Idling,
            - `1`: Acknowledged,
            - `2`: InPreparation,
            - `3`: Ready,
            - `4`: Delivered,
            - `5`: Other,
            - `6`: Cancelled,
            - `7`: Rejected
      required:
        - orderIds
        - orderState
  securitySchemes:
    Bearer:
      type: http
      description: |
        JWT Authorization header using the Bearer scheme. Example: 'Authorization: Bearer {token}'.
      scheme: bearer
